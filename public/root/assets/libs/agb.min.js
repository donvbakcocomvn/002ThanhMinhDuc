var ngayHienTai = new Date();

function loadFile4Path(t) {

    var e = "/" + t.Key + "/" + t.Name + ".html", r = t.Name.charAt(0).toUpperCase() + t.Name.slice(1);
    document.write('<script src="' + e.replace(".html", "Controller.js?v=" + ngayHienTai.getTime()) + '"><\/script>'),
            document.write('<script src="' + e.replace(".html", "Services.js?v=" + ngayHienTai.getTime()) + '"><\/script>'),
            document.write('<script>app.directive("bakco' + r + '", function () {return {restrict: "CAE",controller: "' + r.toLowerCase() + 'Controller",templateUrl: "' + e + '"}});<\/script>')
}
function testInterceptor() {
    return {
        request: function(config) {
            var token = JSON.parse(window.localStorage.getItem("token"));
//            console.log(token);
//            console.log(config);
            if (token) {
                config.headers['Authorization'] = "Bearer " + token.access_token;
            }
            config.headers['Content-Type'] = "application/x-www-form-urlencoded";
            return config;

        },
        requestError: function(config) {
            return config;
        },
        response: function(res) {
            return res;
        },
        responseError: function(res) {
            return res;
        }
    }
}

var app = angular.module("rootApp", ["ngRoute"]);
app.factory('testInterceptor', testInterceptor)
        .config(function($httpProvider) {
            $httpProvider.interceptors.push('testInterceptor');
        });
app.config(['$locationProvider', function($locationProvider) {
        $locationProvider.hashPrefix('');
        $locationProvider.html5Mode({
            enabled: false,
            requireBase: false,
            rewriteLinks: false
        });
    }
]);

if (typeof (sysPath) !== 'undefined')
{
    for (x in sysPath)
        loadFile4Path(sysPath[x]);
}



